{% extends "base.html" %}

{% block title %}UI Customization - LXCloud{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Header Section -->
    <div class="row mb-4">
        <div class="col">
            <div class="d-flex align-items-center justify-content-between">
                <div>
                    <h1 class="h2 mb-2 fw-bold">
                        <i class="fas fa-palette text-primary me-3"></i>UI Customization
                    </h1>
                    <p class="text-muted mb-0 fs-5">Customize the appearance and branding of your LXCloud instance</p>
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-outline-secondary" id="previewBtn">
                        <i class="fas fa-eye me-2"></i>Preview Changes
                    </button>
                    <button class="btn btn-outline-primary" id="resetBtn">
                        <i class="fas fa-undo me-2"></i>Reset to Default
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Card -->
    <div class="row">
        <div class="col">
            <div class="card border-0 shadow-lg rounded-4">
                <!-- Modern Tab Navigation -->
                <div class="card-header bg-gradient-primary text-white border-0 rounded-top-4">
                    <nav>
                        <div class="nav nav-pills nav-justified" id="nav-tab" role="tablist">
                            {% for page, customization in customizations.items() %}
                            <button class="nav-link text-white border-0 px-4 py-3 {% if loop.first %}active{% endif %}" 
                                    id="{{ page }}-tab" 
                                    data-bs-toggle="pill" 
                                    data-bs-target="#{{ page }}-pane" 
                                    type="button" 
                                    role="tab" 
                                    aria-controls="{{ page }}-pane"
                                    aria-selected="{% if loop.first %}true{% else %}false{% endif %}">
                                <i class="fas {% if page == 'dashboard' %}fa-tachometer-alt{% elif page == 'login' %}fa-sign-in-alt{% elif page == 'controllers' %}fa-microchip{% else %}fa-user{% endif %} me-2"></i>
                                {{ page.replace('_', ' ').title() }}
                            </button>
                            {% endfor %}
                        </div>
                    </nav>
                </div>
                <!-- Tab Content -->
                <div class="card-body p-4">
                    <div class="tab-content" id="nav-tabContent">
                        {% for page, customization in customizations.items() %}
                        <div class="tab-pane fade {% if loop.first %}show active{% endif %}" 
                             id="{{ page }}-pane" 
                             role="tabpanel" 
                             aria-labelledby="{{ page }}-tab"
                             tabindex="0">
                            
                            <!-- Progress Indicator -->
                            <div class="progress mb-4" style="height: 4px;">
                                <div class="progress-bar bg-success" role="progressbar" style="width: 0%" id="progress-{{ page }}"></div>
                            </div>

                            <form method="POST" 
                                  action="{{ url_for('admin.save_ui_customization', page_name=page) }}" 
                                  enctype="multipart/form-data"
                                  class="customization-form"
                                  data-page="{{ page }}">
                                
                                <div class="row g-4">
                                    <!-- Header Configuration Panel -->
                                    <div class="col-lg-6">
                                        <div class="card h-100 border-0 bg-light">
                                            <div class="card-body">
                                                <h5 class="card-title text-primary mb-4">
                                                    <i class="fas fa-window-maximize me-2"></i>Header Configuration
                                                </h5>
                                                
                                                <div class="mb-4">
                                                    <label for="header_logo_text_{{ page }}" class="form-label fw-semibold">
                                                        <i class="fas fa-font me-1"></i>Logo Text
                                                    </label>
                                                    <input type="text" 
                                                           class="form-control form-control-lg" 
                                                           id="header_logo_text_{{ page }}" 
                                                           name="header_logo_text" 
                                                           value="{{ customization.get_header_config().get('logo_text', 'LXCloud') }}"
                                                           placeholder="Enter logo text">
                                                    <div class="form-text">This text will appear as your brand name</div>
                                                </div>
                                                
                                                <div class="mb-4">
                                                    <label for="logo_file_{{ page }}" class="form-label fw-semibold">
                                                        <i class="fas fa-image me-1"></i>Custom Logo Image
                                                    </label>
                                                    <input type="file" 
                                                           class="form-control" 
                                                           id="logo_file_{{ page }}" 
                                                           name="logo_file" 
                                                           accept="image/*">
                                                    <div class="form-text">
                                                        <i class="fas fa-info-circle me-1"></i>
                                                        Upload PNG, JPG, or SVG. Recommended size: 40x40px
                                                    </div>
                                                    {% if customization.logo_filename %}
                                                    <div class="mt-3 p-3 bg-success bg-opacity-10 border border-success border-opacity-25 rounded">
                                                        <div class="d-flex align-items-center">
                                                            <img src="{{ url_for('static', filename='uploads/' + customization.logo_filename) }}" 
                                                                 alt="Current logo" 
                                                                 class="img-thumbnail me-3" 
                                                                 style="max-height: 50px;">
                                                            <div>
                                                                <small class="text-success fw-semibold">
                                                                    <i class="fas fa-check-circle me-1"></i>Current Logo
                                                                </small>
                                                                <div class="text-muted small">{{ customization.logo_filename }}</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% endif %}
                                                </div>
                                                
                                                <div class="mb-4">
                                                    <label for="header_height_{{ page }}" class="form-label fw-semibold">
                                                        <i class="fas fa-arrows-alt-v me-1"></i>Header Height
                                                    </label>
                                                    <div class="input-group">
                                                        <input type="text" 
                                                               class="form-control" 
                                                               id="header_height_{{ page }}" 
                                                               name="header_height" 
                                                               value="{{ customization.get_header_config().get('height', '60px') }}"
                                                               placeholder="60px">
                                                        <span class="input-group-text">px</span>
                                                    </div>
                                                </div>
                                                
                                                <div class="row g-3">
                                                    <div class="col-6">
                                                        <label for="header_bg_color_{{ page }}" class="form-label fw-semibold">
                                                            <i class="fas fa-fill-drip me-1"></i>Background
                                                        </label>
                                                        <input type="color" 
                                                               class="form-control form-control-color w-100" 
                                                               id="header_bg_color_{{ page }}" 
                                                               name="header_bg_color" 
                                                               value="{{ customization.get_header_config().get('background_color', '#2c3e50') }}"
                                                               title="Choose background color">
                                                    </div>
                                                    <div class="col-6">
                                                        <label for="header_text_color_{{ page }}" class="form-label fw-semibold">
                                                            <i class="fas fa-palette me-1"></i>Text Color
                                                        </label>
                                                        <input type="color" 
                                                               class="form-control form-control-color w-100" 
                                                               id="header_text_color_{{ page }}" 
                                                               name="header_text_color" 
                                                               value="{{ customization.get_header_config().get('text_color', '#ffffff') }}"
                                                               title="Choose text color">
                                                    </div>
                                                </div>
                                                
                                                <!-- Advanced Spacing Controls -->
                                                <div class="mt-4">
                                                    <h6 class="text-secondary mb-3">
                                                        <i class="fas fa-expand-arrows-alt me-1"></i>Advanced Spacing
                                                    </h6>
                                                    <div class="row g-3">
                                                        <div class="col-4">
                                                            <label for="logo_left_padding_{{ page }}" class="form-label small">Logo Padding</label>
                                                            <input type="text" 
                                                                   class="form-control form-control-sm" 
                                                                   id="logo_left_padding_{{ page }}" 
                                                                   name="logo_left_padding" 
                                                                   value="{{ customization.get_header_config().get('logo_left_padding', '15px') }}"
                                                                   placeholder="15px">
                                                        </div>
                                                        <div class="col-4">
                                                            <label for="logo_menu_spacing_{{ page }}" class="form-label small">Menu Spacing</label>
                                                            <input type="text" 
                                                                   class="form-control form-control-sm" 
                                                                   id="logo_menu_spacing_{{ page }}" 
                                                                   name="logo_menu_spacing" 
                                                                   value="{{ customization.get_header_config().get('logo_menu_spacing', '30px') }}"
                                                                   placeholder="30px">
                                                        </div>
                                                        <div class="col-4">
                                                            <label for="user_button_right_padding_{{ page }}" class="form-label small">User Button</label>
                                                            <input type="text" 
                                                                   class="form-control form-control-sm" 
                                                                   id="user_button_right_padding_{{ page }}" 
                                                                   name="user_button_right_padding" 
                                                                   value="{{ customization.get_header_config().get('user_button_right_padding', '15px') }}"
                                                                   placeholder="15px">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Footer Configuration Panel -->
                                    <div class="col-lg-6">
                                        <div class="card h-100 border-0 bg-light">
                                            <div class="card-body">
                                                <h5 class="card-title text-secondary mb-4">
                                                    <i class="fas fa-window-minimize me-2"></i>Footer Configuration
                                                </h5>
                                                
                                                <div class="mb-4">
                                                    <label for="footer_text_{{ page }}" class="form-label fw-semibold">
                                                        <i class="fas fa-font me-1"></i>Footer Text
                                                    </label>
                                                    <input type="text" 
                                                           class="form-control form-control-lg" 
                                                           id="footer_text_{{ page }}" 
                                                           name="footer_text" 
                                                           value="{{ customization.get_footer_config().get('text', '© 2025 LXCloud') }}"
                                                           placeholder="© 2025 Your Company">
                                                    <div class="form-text">Copyright or footer information</div>
                                                </div>
                                                
                                                <div class="mb-4">
                                                    <label for="footer_height_{{ page }}" class="form-label fw-semibold">
                                                        <i class="fas fa-arrows-alt-v me-1"></i>Footer Height
                                                    </label>
                                                    <div class="input-group">
                                                        <input type="text" 
                                                               class="form-control" 
                                                               id="footer_height_{{ page }}" 
                                                               name="footer_height" 
                                                               value="{{ customization.get_footer_config().get('height', '40px') }}"
                                                               placeholder="40px">
                                                        <span class="input-group-text">px</span>
                                                    </div>
                                                </div>
                                                
                                                <div class="row g-3">
                                                    <div class="col-6">
                                                        <label for="footer_bg_color_{{ page }}" class="form-label fw-semibold">
                                                            <i class="fas fa-fill-drip me-1"></i>Background
                                                        </label>
                                                        <input type="color" 
                                                               class="form-control form-control-color w-100" 
                                                               id="footer_bg_color_{{ page }}" 
                                                               name="footer_bg_color" 
                                                               value="{{ customization.get_footer_config().get('background_color', '#34495e') }}"
                                                               title="Choose background color">
                                                    </div>
                                                    <div class="col-6">
                                                        <label for="footer_text_color_{{ page }}" class="form-label fw-semibold">
                                                            <i class="fas fa-palette me-1"></i>Text Color
                                                        </label>
                                                        <input type="color" 
                                                               class="form-control form-control-color w-100" 
                                                               id="footer_text_color_{{ page }}" 
                                                               name="footer_text_color" 
                                                               value="{{ customization.get_footer_config().get('text_color', '#ffffff') }}"
                                                               title="Choose text color">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Marker Configuration (Dashboard only) -->
                                {% if page == 'dashboard' %}
                                <div class="mt-5">
                                    <div class="card border-0 bg-warning bg-opacity-10">
                                        <div class="card-body">
                                            <h5 class="card-title text-warning-emphasis mb-4">
                                                <i class="fas fa-map-marker-alt me-2"></i>Controller Marker Configuration
                                            </h5>
                                            <p class="text-muted mb-4 fs-6">
                                                <i class="fas fa-info-circle me-1"></i>
                                                Customize map markers for each controller type with different styles for online and offline states.
                                            </p>
                                            
                                            {% set marker_config = customization.get_marker_config() %}
                                            {% set controller_types = [
                                                ('speedradar', 'Speed Radar', 'fas fa-tachometer-alt', 'primary'),
                                                ('beaufortmeter', 'Beaufort Meter', 'fas fa-wind', 'info'),
                                                ('weatherstation', 'Weather Station', 'fas fa-cloud-sun', 'warning'),
                                                ('aicamera', 'AI Camera', 'fas fa-camera', 'danger'),
                                                ('default', 'Default', 'fas fa-microchip', 'secondary')
                                            ] %}
                                            
                                            <div class="row g-4">
                                                {% for controller_type, display_name, default_icon, color_class in controller_types %}
                                                <div class="col-lg-6 mb-4">
                                                    <div class="card border-0 shadow-sm">
                                                        <div class="card-header bg-{{ color_class }} bg-opacity-10 border-bottom-0">
                                                            <h6 class="mb-0 text-{{ color_class }}-emphasis fw-semibold">
                                                                <i class="{{ default_icon }} me-2"></i>{{ display_name }}
                                                            </h6>
                                                        </div>
                                                        <div class="card-body">
                                                            <!-- Online Marker Configuration -->
                                                            <div class="mb-4 p-3 bg-success bg-opacity-5 rounded">
                                                                <div class="d-flex align-items-center mb-3">
                                                                    <div class="badge bg-success me-2">
                                                                        <i class="fas fa-circle"></i>
                                                                    </div>
                                                                    <h6 class="mb-0 text-success-emphasis">Online State</h6>
                                                                </div>
                                                                
                                                                <div class="row g-2">
                                                                    <div class="col-12">
                                                                        <label class="form-label small fw-semibold">Font Awesome Icon</label>
                                                                        <div class="input-group input-group-sm">
                                                                            <span class="input-group-text">
                                                                                <i class="{{ marker_config.get(controller_type, {}).get('online', {}).get('icon', default_icon) }}"></i>
                                                                            </span>
                                                                            <input type="text" 
                                                                                   class="form-control" 
                                                                                   name="marker_{{ controller_type }}_online_icon" 
                                                                                   value="{{ marker_config.get(controller_type, {}).get('online', {}).get('icon', default_icon) }}"
                                                                                   placeholder="{{ default_icon }}">
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-6">
                                                                        <label class="form-label small fw-semibold">Color</label>
                                                                        <input type="color" 
                                                                               class="form-control form-control-color form-control-sm w-100" 
                                                                               name="marker_{{ controller_type }}_online_color" 
                                                                               value="{{ marker_config.get(controller_type, {}).get('online', {}).get('color', '#28a745') }}">
                                                                    </div>
                                                                    <div class="col-6">
                                                                        <label class="form-label small fw-semibold">Size (px)</label>
                                                                        <input type="range" 
                                                                               class="form-range" 
                                                                               name="marker_{{ controller_type }}_online_size" 
                                                                               min="20" max="50" 
                                                                               value="{{ marker_config.get(controller_type, {}).get('online', {}).get('size', '30') }}"
                                                                               id="range_{{ controller_type }}_online">
                                                                        <div class="d-flex justify-content-between small text-muted">
                                                                            <span>20</span>
                                                                            <span id="value_{{ controller_type }}_online" class="fw-semibold">{{ marker_config.get(controller_type, {}).get('online', {}).get('size', '30') }}</span>
                                                                            <span>50</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <!-- Custom Icon Upload -->
                                                                <div class="mt-3">
                                                                    <label class="form-label small fw-semibold">Custom PNG Icon</label>
                                                                    <input type="file" 
                                                                           class="form-control form-control-sm" 
                                                                           name="marker_{{ controller_type }}_online_icon_file" 
                                                                           accept=".png">
                                                                    {% if marker_config.get(controller_type, {}).get('online', {}).get('custom_icon') %}
                                                                    <div class="mt-2 d-flex align-items-center">
                                                                        <img src="{{ url_for('static', filename='uploads/' + marker_config.get(controller_type, {}).get('online', {}).get('custom_icon')) }}" 
                                                                             alt="Online marker icon" 
                                                                             class="img-thumbnail me-2" 
                                                                             style="max-height: 25px;">
                                                                        <small class="text-success">
                                                                            <i class="fas fa-check-circle me-1"></i>
                                                                            {{ marker_config.get(controller_type, {}).get('online', {}).get('custom_icon') }}
                                                                        </small>
                                                                    </div>
                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Offline Marker Configuration -->
                                                            <div class="p-3 bg-danger bg-opacity-5 rounded">
                                                                <div class="d-flex align-items-center mb-3">
                                                                    <div class="badge bg-danger me-2">
                                                                        <i class="fas fa-circle"></i>
                                                                    </div>
                                                                    <h6 class="mb-0 text-danger-emphasis">Offline State</h6>
                                                                </div>
                                                                
                                                                <div class="row g-2">
                                                                    <div class="col-12">
                                                                        <label class="form-label small fw-semibold">Font Awesome Icon</label>
                                                                        <div class="input-group input-group-sm">
                                                                            <span class="input-group-text">
                                                                                <i class="{{ marker_config.get(controller_type, {}).get('offline', {}).get('icon', default_icon) }}"></i>
                                                                            </span>
                                                                            <input type="text" 
                                                                                   class="form-control" 
                                                                                   name="marker_{{ controller_type }}_offline_icon" 
                                                                                   value="{{ marker_config.get(controller_type, {}).get('offline', {}).get('icon', default_icon) }}"
                                                                                   placeholder="{{ default_icon }}">
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-6">
                                                                        <label class="form-label small fw-semibold">Color</label>
                                                                        <input type="color" 
                                                                               class="form-control form-control-color form-control-sm w-100" 
                                                                               name="marker_{{ controller_type }}_offline_color" 
                                                                               value="{{ marker_config.get(controller_type, {}).get('offline', {}).get('color', '#dc3545') }}">
                                                                    </div>
                                                                    <div class="col-6">
                                                                        <label class="form-label small fw-semibold">Size (px)</label>
                                                                        <input type="range" 
                                                                               class="form-range" 
                                                                               name="marker_{{ controller_type }}_offline_size" 
                                                                               min="20" max="50" 
                                                                               value="{{ marker_config.get(controller_type, {}).get('offline', {}).get('size', '30') }}"
                                                                               id="range_{{ controller_type }}_offline">
                                                                        <div class="d-flex justify-content-between small text-muted">
                                                                            <span>20</span>
                                                                            <span id="value_{{ controller_type }}_offline" class="fw-semibold">{{ marker_config.get(controller_type, {}).get('offline', {}).get('size', '30') }}</span>
                                                                            <span>50</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <!-- Custom Icon Upload -->
                                                                <div class="mt-3">
                                                                    <label class="form-label small fw-semibold">Custom PNG Icon</label>
                                                                    <input type="file" 
                                                                           class="form-control form-control-sm" 
                                                                           name="marker_{{ controller_type }}_offline_icon_file" 
                                                                           accept=".png">
                                                                    {% if marker_config.get(controller_type, {}).get('offline', {}).get('custom_icon') %}
                                                                    <div class="mt-2 d-flex align-items-center">
                                                                        <img src="{{ url_for('static', filename='uploads/' + marker_config.get(controller_type, {}).get('offline', {}).get('custom_icon')) }}" 
                                                                             alt="Offline marker icon" 
                                                                             class="img-thumbnail me-2" 
                                                                             style="max-height: 25px;">
                                                                        <small class="text-success">
                                                                            <i class="fas fa-check-circle me-1"></i>
                                                                            {{ marker_config.get(controller_type, {}).get('offline', {}).get('custom_icon') }}
                                                                        </small>
                                                                    </div>
                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            
                                            <!-- Usage Tips -->
                                            <div class="alert alert-info border-0 bg-info bg-opacity-10 mt-4">
                                                <h6 class="alert-heading text-info-emphasis">
                                                    <i class="fas fa-lightbulb me-2"></i>Pro Tips
                                                </h6>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <ul class="mb-0 small">
                                                            <li>Use Font Awesome classes like <code>fas fa-camera</code></li>
                                                            <li>Custom PNG icons override Font Awesome icons</li>
                                                            <li>Recommended icon size: 20-50 pixels</li>
                                                        </ul>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <ul class="mb-0 small">
                                                            <li>Icons are automatically centered on markers</li>
                                                            <li>Use high contrast colors for visibility</li>
                                                            <li>Changes apply immediately to dashboard map</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Custom CSS Tab -->
                    <div class="tab-pane fade" id="nav-css" role="tabpanel">
                        <div class="d-flex align-items-center mb-4">
                            <div class="progress flex-grow-1 me-3" style="height: 4px;">
                                <div class="progress-bar bg-success" style="width: 100%"></div>
                            </div>
                            <span class="badge bg-success">Step 4 of 4</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-12">
                                <div class="card border-0 shadow-sm">
                                    <div class="card-header bg-gradient-success text-white border-bottom-0">
                                        <h5 class="card-title mb-0">
                                            <i class="fas fa-code me-2"></i>Custom CSS Styling
                                        </h5>
                                        <small class="opacity-75">Advanced customization with custom CSS code</small>
                                    </div>
                                    <div class="card-body">
                                        <p class="text-muted mb-4">
                                            <i class="fas fa-info-circle me-1"></i>
                                            Add custom CSS to override default styles and create unique designs. CSS will be applied to the <strong>{{ page }}</strong> page.
                                        </p>
                                        
                                        <!-- CSS Editor -->
                                        <div class="mb-4">
                                            <label for="custom_css" class="form-label fw-semibold">
                                                <i class="fas fa-palette me-2"></i>CSS Code Editor
                                            </label>
                                            <div class="position-relative">
                                                <textarea class="form-control font-monospace" 
                                                          id="custom_css" 
                                                          name="custom_css" 
                                                          rows="20"
                                                          placeholder="/* Enter your custom CSS here */&#10;/* Example: */&#10;.navbar-brand {&#10;    font-size: 1.5rem;&#10;    font-weight: bold;&#10;}&#10;&#10;.card {&#10;    border-radius: 15px;&#10;    box-shadow: 0 4px 15px rgba(0,0,0,0.1);&#10;}&#10;&#10;/* Dashboard specific styles */&#10;.controller-card {&#10;    transition: transform 0.2s;&#10;}&#10;&#10;.controller-card:hover {&#10;    transform: translateY(-2px);&#10;}">{{ customization.get_custom_css(page) }}</textarea>
                                                <div class="position-absolute top-0 end-0 m-2">
                                                    <small class="badge bg-secondary" id="css-line-count">
                                                        <i class="fas fa-list-ol me-1"></i>Lines: 0
                                                    </small>
                                                </div>
                                            </div>
                                            <div class="form-text">
                                                <i class="fas fa-lightbulb me-1"></i>
                                                <strong>Pro tip:</strong> Use browser developer tools (F12) to inspect elements and find the right CSS selectors.
                                            </div>
                                        </div>
                                        
                                        <!-- CSS Validation & Preview -->
                                        <div class="row mb-4">
                                            <div class="col-md-6">
                                                <div class="card bg-light border-0">
                                                    <div class="card-body">
                                                        <h6 class="card-title text-primary">
                                                            <i class="fas fa-check-circle me-2"></i>Validation
                                                        </h6>
                                                        <div id="css-validation-result" class="small">
                                                            <span class="text-muted">
                                                                <i class="fas fa-spinner fa-spin me-1"></i>
                                                                Type CSS to validate...
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="card bg-light border-0">
                                                    <div class="card-body">
                                                        <h6 class="card-title text-info">
                                                            <i class="fas fa-eye me-2"></i>Live Preview
                                                        </h6>
                                                        <button type="button" class="btn btn-outline-info btn-sm" id="preview-css-btn">
                                                            <i class="fas fa-external-link-alt me-1"></i>
                                                            Preview Changes
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Common CSS Examples -->
                                        <div class="card border-0 bg-info bg-opacity-10">
                                            <div class="card-header bg-transparent border-bottom-0">
                                                <h6 class="mb-0 text-info-emphasis">
                                                    <i class="fas fa-magic me-2"></i>Common CSS Examples
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="row g-3">
                                                    <div class="col-md-6">
                                                        <div class="d-grid gap-2">
                                                            <button type="button" class="btn btn-outline-secondary btn-sm css-example-btn" 
                                                                    data-css="/* Custom color scheme */&#10;:root {&#10;    --bs-primary: #6f42c1;&#10;    --bs-success: #198754;&#10;}">
                                                                <i class="fas fa-palette me-1"></i>Color Scheme
                                                            </button>
                                                            <button type="button" class="btn btn-outline-secondary btn-sm css-example-btn" 
                                                                    data-css="/* Rounded corners */&#10;.card, .btn {&#10;    border-radius: 15px !important;&#10;}">
                                                                <i class="fas fa-shapes me-1"></i>Rounded Design
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="d-grid gap-2">
                                                            <button type="button" class="btn btn-outline-secondary btn-sm css-example-btn" 
                                                                    data-css="/* Animated transitions */&#10;.card, .btn {&#10;    transition: all 0.3s ease;&#10;}&#10;.card:hover {&#10;    transform: translateY(-5px);&#10;    box-shadow: 0 8px 25px rgba(0,0,0,0.15);&#10;}">
                                                                <i class="fas fa-magic me-1"></i>Animations
                                                            </button>
                                                            <button type="button" class="btn btn-outline-secondary btn-sm css-example-btn" 
                                                                    data-css="/* Dark theme */&#10;body {&#10;    background-color: #1a1a1a;&#10;    color: #ffffff;&#10;}&#10;.card {&#10;    background-color: #2d2d2d;&#10;    border-color: #404040;&#10;}">
                                                                <i class="fas fa-moon me-1"></i>Dark Theme
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Important Notes -->
                                        <div class="alert alert-warning border-0 bg-warning bg-opacity-10 mt-4">
                                            <h6 class="alert-heading text-warning-emphasis">
                                                <i class="fas fa-exclamation-triangle me-2"></i>Important Notes
                                            </h6>
                                            <ul class="mb-0 small">
                                                <li><strong>Scope:</strong> CSS only applies to the current page ({{ page }})</li>
                                                <li><strong>Priority:</strong> Use <code>!important</code> to override existing styles</li>
                                                <li><strong>Responsiveness:</strong> Test on different screen sizes</li>
                                                <li><strong>Performance:</strong> Avoid complex selectors and excessive animations</li>
                                                <li><strong>Backup:</strong> Save your CSS code before making major changes</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Save Button -->
                <div class="row mt-5">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm bg-gradient-light">
                            <div class="card-body text-center">
                                <h5 class="card-title text-success mb-3">
                                    <i class="fas fa-save me-2"></i>Save Your Customizations
                                </h5>
                                <p class="text-muted mb-4">
                                    Ready to apply your changes? Click the button below to save all customizations for the <strong>{{ page }}</strong> page.
                                </p>
                                
                                <div class="d-flex justify-content-center gap-3">
                                    <button type="button" class="btn btn-outline-secondary" id="reset-form-btn">
                                        <i class="fas fa-undo me-2"></i>Reset Changes
                                    </button>
                                    <button type="submit" class="btn btn-success btn-lg px-5" id="save-btn">
                                        <i class="fas fa-check-circle me-2"></i>Save Customizations
                                    </button>
                                    <button type="button" class="btn btn-outline-info" id="preview-all-btn">
                                        <i class="fas fa-eye me-2"></i>Preview All
                                    </button>
                                </div>
                                
                                <div class="mt-3">
                                    <small class="text-muted">
                                        <i class="fas fa-info-circle me-1"></i>
                                        Changes will be applied immediately and visible on the {{ page }} page.
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modern JavaScript for Enhanced Functionality -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize Bootstrap components (if needed)
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
        
        // Tab functionality with smooth transitions
        const navLinks = document.querySelectorAll('[data-bs-toggle="pill"]');
        const tabPanes = document.querySelectorAll('.tab-pane');
        
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active classes with animation
                navLinks.forEach(nav => {
                    nav.classList.remove('active');
                    nav.style.transform = 'scale(1)';
                });
                tabPanes.forEach(pane => {
                    pane.classList.remove('show', 'active');
                });
                
                // Add active class with animation
                this.classList.add('active');
                this.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 200);
                
                // Show corresponding tab pane with fade effect
                const target = this.getAttribute('data-bs-target');
                const targetPane = document.querySelector(target);
                if (targetPane) {
                    setTimeout(() => {
                        targetPane.classList.add('show', 'active');
                    }, 150);
                }
                
                // Update progress indicators
                updateProgressIndicator(target);
            });
        });
        
        // Progress indicator updates with smooth animation
        function updateProgressIndicator(activeTab) {
            const progressBars = document.querySelectorAll('.progress-bar');
            const steps = {
                '#nav-header': 25,
                '#nav-footer': 50, 
                '#nav-markers': 75,
                '#nav-css': 100
            };
            
            progressBars.forEach(bar => {
                const width = (steps[activeTab] || 25) + '%';
                bar.style.transition = 'width 0.5s ease-in-out';
                bar.style.width = width;
            });
        }
        
        // Range sliders for marker sizes with real-time preview
        const rangeInputs = document.querySelectorAll('input[type="range"]');
        rangeInputs.forEach(range => {
            const valueDisplay = document.getElementById(range.id.replace('range_', 'value_'));
            if (valueDisplay) {
                // Initial value
                valueDisplay.textContent = range.value;
                
                // Update on input
                range.addEventListener('input', function() {
                    valueDisplay.textContent = this.value;
                    
                    // Add visual feedback
                    valueDisplay.style.transform = 'scale(1.2)';
                    valueDisplay.style.color = '#007bff';
                    setTimeout(() => {
                        valueDisplay.style.transform = 'scale(1)';
                        valueDisplay.style.color = '';
                    }, 300);
                });
            }
        });
        
        // CSS Editor enhancements
        const cssTextarea = document.getElementById('custom_css');
        const lineCountBadge = document.getElementById('css-line-count');
        
        if (cssTextarea && lineCountBadge) {
            function updateLineCount() {
                const lines = cssTextarea.value.split('\n').length;
                lineCountBadge.innerHTML = `<i class="fas fa-list-ol me-1"></i>Lines: ${lines}`;
                
                // Change badge color based on content length
                if (lines > 50) {
                    lineCountBadge.className = 'badge bg-warning';
                } else if (lines > 20) {
                    lineCountBadge.className = 'badge bg-info';
                } else {
                    lineCountBadge.className = 'badge bg-secondary';
                }
            }
            
            // Add line numbers (visual enhancement)
            cssTextarea.addEventListener('input', function() {
                updateLineCount();
                
                // Simple CSS validation feedback
                const validationResult = document.getElementById('css-validation-result');
                if (validationResult) {
                    const css = this.value.trim();
                    if (css.length === 0) {
                        validationResult.innerHTML = '<span class="text-muted"><i class="fas fa-spinner fa-spin me-1"></i>Type CSS to validate...</span>';
                    } else if (css.includes('{') && css.includes('}')) {
                        validationResult.innerHTML = '<span class="text-success"><i class="fas fa-check-circle me-1"></i>CSS structure looks good!</span>';
                    } else {
                        validationResult.innerHTML = '<span class="text-warning"><i class="fas fa-exclamation-triangle me-1"></i>Check CSS syntax</span>';
                    }
                }
            });
            
            cssTextarea.addEventListener('scroll', updateLineCount);
            updateLineCount(); // Initial count
        }
        
        // CSS Example buttons with smooth insertion
        const exampleBtns = document.querySelectorAll('.css-example-btn');
        exampleBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const css = this.getAttribute('data-css').replace(/&#10;/g, '\n');
                if (cssTextarea) {
                    // Add with animation feedback
                    this.style.transform = 'scale(0.95)';
                    this.innerHTML = '<i class="fas fa-check me-1"></i>Added!';
                    
                    setTimeout(() => {
                        cssTextarea.value += '\n\n' + css;
                        updateLineCount();
                        
                        // Scroll to bottom of textarea
                        cssTextarea.scrollTop = cssTextarea.scrollHeight;
                        
                        // Reset button
                        this.style.transform = 'scale(1)';
                        this.innerHTML = this.innerHTML.replace('<i class="fas fa-check me-1"></i>Added!', this.getAttribute('data-original-text') || this.textContent);
                    }, 500);
                }
            });
            
            // Store original text for reset
            btn.setAttribute('data-original-text', btn.innerHTML);
        });
        
        // Form validation and enhanced interactions
        const form = document.querySelector('form');
        const saveBtn = document.getElementById('save-btn');
        const resetBtn = document.getElementById('reset-form-btn');
        const previewBtn = document.getElementById('preview-all-btn');
        
        // Reset functionality with confirmation
        if (resetBtn) {
            resetBtn.addEventListener('click', function() {
                const confirmReset = confirm('⚠️ Are you sure you want to reset all changes?\\n\\nThis will restore all settings to their default values.');
                if (confirmReset) {
                    form.reset();
                    updateLineCount();
                    
                    // Visual feedback
                    this.innerHTML = '<i class="fas fa-check me-2"></i>Reset Complete!';
                    this.classList.add('btn-success');
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-undo me-2"></i>Reset Changes';
                        this.classList.remove('btn-success');
                    }, 2000);
                }
            });
        }
        
        // Enhanced preview functionality
        if (previewBtn) {
            previewBtn.addEventListener('click', function() {
                const btn = this;
                btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Generating Preview...';
                btn.disabled = true;
                
                setTimeout(() => {
                    // Create enhanced preview
                    const previewWindow = window.open('', '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
                    previewWindow.document.write(`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                            <title>UI Customization Preview - ${document.title}</title>
                            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
                            <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                            <style>
                                body { padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
                                .preview-container { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
                                .preview-header { text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; }
                                .sample-card { margin-bottom: 20px; transition: transform 0.3s ease; }
                                .sample-card:hover { transform: translateY(-5px); }
                                ${cssTextarea ? cssTextarea.value : ''}
                            </style>
                        </head>
                        <body>
                            <div class="preview-container">
                                <div class="preview-header">
                                    <h1><i class="fas fa-eye me-2"></i>Live Preview</h1>
                                    <p class="mb-0">Your customizations for the <strong>${document.querySelector('[name="page"]')?.value || 'dashboard'}</strong> page</p>
                                </div>
                                
                                <div class="alert alert-info border-0">
                                    <h5><i class="fas fa-info-circle me-2"></i>Preview Information</h5>
                                    <p class="mb-0">This preview shows how your CSS customizations will affect the page appearance. The actual implementation may vary slightly based on existing page structure.</p>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card sample-card">
                                            <div class="card-header"><i class="fas fa-chart-bar me-2"></i>Sample Dashboard Card</div>
                                            <div class="card-body">
                                                <h5 class="card-title">Controller Status</h5>
                                                <p class="card-text">This is how dashboard cards will appear with your styling.</p>
                                                <button class="btn btn-primary">View Details</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card sample-card">
                                            <div class="card-header"><i class="fas fa-cog me-2"></i>Settings Panel</div>
                                            <div class="card-body">
                                                <form>
                                                    <div class="mb-3">
                                                        <label class="form-label">Sample Setting</label>
                                                        <input type="text" class="form-control" value="Configuration value">
                                                    </div>
                                                    <button class="btn btn-success">Save Settings</button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="text-center mt-4">
                                    <button class="btn btn-secondary" onclick="window.close()">
                                        <i class="fas fa-times me-2"></i>Close Preview
                                    </button>
                                </div>
                            </div>
                            
                            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
                        </body>
                        </html>
                    `);
                    
                    // Reset button
                    btn.innerHTML = '<i class="fas fa-eye me-2"></i>Preview All';
                    btn.disabled = false;
                }, 1500);
            });
        }
        
        // Enhanced form submission with progress indication
        if (form && saveBtn) {
            form.addEventListener('submit', function(e) {
                // Add loading state
                saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Saving Changes...';
                saveBtn.disabled = true;
                saveBtn.classList.add('btn-warning');
                saveBtn.classList.remove('btn-success');
                
                // Simulate progress (remove this in production)
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 10;
                    if (progress <= 100) {
                        saveBtn.innerHTML = `<i class="fas fa-spinner fa-spin me-2"></i>Saving... ${progress}%`;
                    }
                }, 100);
                
                // Clear interval after form submission (this will be handled by actual form processing)
                setTimeout(() => {
                    clearInterval(interval);
                }, 1000);
            });
        }
        
        // Color picker enhancements with live preview
        const colorInputs = document.querySelectorAll('input[type="color"]');
        colorInputs.forEach(input => {
            input.addEventListener('change', function() {
                // Visual feedback animation
                this.style.transform = 'scale(1.2) rotate(360deg)';
                this.style.transition = 'transform 0.5s ease-in-out';
                
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 500);
                
                // Show color value tooltip
                const colorValue = this.value;
                const tooltip = document.createElement('div');
                tooltip.className = 'position-absolute bg-dark text-white p-1 rounded small';
                tooltip.style.zIndex = '1000';
                tooltip.style.top = '-30px';
                tooltip.style.left = '50%';
                tooltip.style.transform = 'translateX(-50%)';
                tooltip.textContent = colorValue;
                
                this.parentElement.style.position = 'relative';
                this.parentElement.appendChild(tooltip);
                
                setTimeout(() => {
                    tooltip.remove();
                }, 2000);
            });
        });
        
        // File upload enhancements with drag & drop
        const fileInputs = document.querySelectorAll('input[type="file"]');
        fileInputs.forEach(input => {
            // Create drop zone
            const dropZone = document.createElement('div');
            dropZone.className = 'border-2 border-dashed border-secondary rounded p-3 text-center mt-2 d-none';
            dropZone.innerHTML = '<i class="fas fa-cloud-upload-alt fa-2x text-muted mb-2"></i><br><small class="text-muted">Drop files here or click to browse</small>';
            input.parentElement.insertBefore(dropZone, input.nextSibling);
            
            // Drag and drop functionality
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => {
                    dropZone.classList.add('border-primary', 'bg-primary', 'bg-opacity-10');
                }, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => {
                    dropZone.classList.remove('border-primary', 'bg-primary', 'bg-opacity-10');
                }, false);
            });
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                input.files = files;
                handleFileUpload(files[0], input);
            }
            
            // Regular file input change
            input.addEventListener('change', function() {
                if (this.files[0]) {
                    handleFileUpload(this.files[0], this);
                }
            });
            
            function handleFileUpload(file, inputElement) {
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Remove existing preview
                        const existingPreview = inputElement.parentElement.querySelector('.preview-image');
                        if (existingPreview) {
                            existingPreview.remove();
                        }
                        
                        // Create new preview
                        const preview = document.createElement('div');
                        preview.className = 'preview-image mt-2 d-flex align-items-center p-2 bg-light rounded';
                        preview.innerHTML = `
                            <img src="${e.target.result}" alt="Preview" class="img-thumbnail me-2" style="max-height: 40px; max-width: 40px;">
                            <div class="flex-grow-1">
                                <small class="text-success fw-semibold d-block">
                                    <i class="fas fa-check-circle me-1"></i>${file.name}
                                </small>
                                <small class="text-muted">${(file.size / 1024).toFixed(1)} KB</small>
                            </div>
                            <button type="button" class="btn btn-sm btn-outline-danger" onclick="this.parentElement.remove(); inputElement.value='';">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        
                        inputElement.parentElement.appendChild(preview);
                    };
                    reader.readAsDataURL(file);
                }
            }
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl+S to save (prevent default browser save)
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                if (saveBtn && !saveBtn.disabled) {
                    saveBtn.click();
                }
            }
            
            // Ctrl+R to reset
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                if (resetBtn) {
                    resetBtn.click();
                }
            }
        });
        
        // Auto-save draft functionality (optional)
        let autoSaveTimer;
        const formInputs = form.querySelectorAll('input, textarea, select');
        formInputs.forEach(input => {
            input.addEventListener('input', function() {
                clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    // Save draft to localStorage
                    const formData = new FormData(form);
                    const draftData = {};
                    for (let [key, value] of formData.entries()) {
                        draftData[key] = value;
                    }
                    localStorage.setItem('ui_customization_draft', JSON.stringify(draftData));
                    
                    // Show draft saved indicator
                    const indicator = document.createElement('div');
                    indicator.className = 'position-fixed top-0 end-0 m-3 alert alert-success alert-dismissible';
                    indicator.style.zIndex = '9999';
                    indicator.innerHTML = '<i class="fas fa-save me-2"></i>Draft saved automatically <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>';
                    document.body.appendChild(indicator);
                    
                    setTimeout(() => {
                        indicator.remove();
                    }, 3000);
                }, 2000);
            });
        });
        
        // Load draft on page load
        const savedDraft = localStorage.getItem('ui_customization_draft');
        if (savedDraft) {
            try {
                const draftData = JSON.parse(savedDraft);
                Object.keys(draftData).forEach(key => {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input) {
                        input.value = draftData[key];
                    }
                });
            } catch (e) {
                console.log('Could not load draft:', e);
            }
        }
    });
    </script>

    <!-- Modern CSS Enhancements -->
    <style>
    /* Enhanced Navigation Pills */
    .nav-pills {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 50px;
        padding: 5px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.18);
    }

    .nav-pills .nav-link {
        border-radius: 50px;
        padding: 12px 24px;
        font-weight: 500;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        color: #6c757d;
        background: transparent;
        border: none;
        position: relative;
        overflow: hidden;
    }

    .nav-pills .nav-link:before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
    }

    .nav-pills .nav-link:hover:before {
        left: 100%;
    }

    .nav-pills .nav-link.active {
        color: white;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transform: translateY(-2px);
    }

    .nav-pills .nav-link i {
        margin-right: 8px;
        transition: transform 0.3s ease;
    }

    .nav-pills .nav-link.active i {
        transform: scale(1.1);
    }

    /* Card Enhancements */
    .card {
        backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .card:hover {
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        transform: translateY(-5px);
    }

    /* Gradient Headers */
    .bg-gradient-primary {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    }

    .bg-gradient-info {
        background: linear-gradient(135deg, #17a2b8 0%, #117a8b 100%);
    }

    .bg-gradient-warning {
        background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
    }

    .bg-gradient-success {
        background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
    }

    .bg-gradient-light {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    }

    /* Form Control Enhancements */
    .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        transform: scale(1.02);
        transition: all 0.3s ease;
    }

    .form-control-color {
        height: 45px;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .form-control-color:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    /* Range Slider Styling */
    .form-range {
        height: 6px;
    }

    .form-range::-webkit-slider-thumb {
        height: 20px;
        width: 20px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: 3px solid white;
        box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        transition: all 0.3s ease;
    }

    .form-range::-webkit-slider-thumb:hover {
        transform: scale(1.2);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
    }

    /* Progress Bar Enhancements */
    .progress {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        border-radius: 50px;
        overflow: hidden;
    }

    .progress-bar {
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        background-size: 200% 100%;
        animation: progressShimmer 2s infinite;
    }

    @keyframes progressShimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    /* Button Enhancements */
    .btn {
        border-radius: 12px;
        font-weight: 500;
        padding: 10px 20px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }

    .btn:before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transition: all 0.5s ease;
        transform: translate(-50%, -50%);
    }

    .btn:hover:before {
        width: 300px;
        height: 300px;
    }

    .btn-success {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        border: none;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }

    .btn-success:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
    }

    /* Alert Enhancements */
    .alert {
        border: none;
        border-radius: 15px;
        backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
    }

    .alert:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
        background-size: 200% 100%;
        animation: alertShimmer 3s infinite;
    }

    @keyframes alertShimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    /* Badge Enhancements */
    .badge {
        border-radius: 20px;
        padding: 8px 12px;
        font-weight: 500;
        backdrop-filter: blur(10px);
    }

    /* Tab Pane Animations */
    .tab-pane {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
    }

    .tab-pane.active {
        opacity: 1;
        transform: translateY(0);
    }

    /* Textarea Enhancements */
    .font-monospace {
        font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
        background: #f8f9fa;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        line-height: 1.5;
        resize: vertical;
        transition: all 0.3s ease;
    }

    .font-monospace:focus {
        background: white;
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.1);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .nav-pills {
            flex-direction: column;
            border-radius: 15px;
        }
        
        .nav-pills .nav-link {
            margin-bottom: 5px;
            text-align: center;
        }
        
        .card-body {
            padding: 1rem;
        }
        
        .progress {
            margin-bottom: 1rem;
        }
    }

    /* Dark Mode Support */
    @media (prefers-color-scheme: dark) {
        .card {
            background: rgba(33, 37, 41, 0.9);
            color: #f8f9fa;
        }
        
        .form-control {
            background: rgba(52, 58, 64, 0.9);
            border-color: #495057;
            color: #f8f9fa;
        }
        
        .font-monospace {
            background: #212529;
            color: #f8f9fa;
            border-color: #495057;
        }
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    /* Loading Animation */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .card, .nav-pills, .btn, .alert {
        animation: fadeInUp 0.6s ease forwards;
    }

    .card:nth-child(2) { animation-delay: 0.1s; }
    .card:nth-child(3) { animation-delay: 0.2s; }
    .card:nth-child(4) { animation-delay: 0.3s; }
    </style>
{% endblock %}